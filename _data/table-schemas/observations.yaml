title: Observations
description: >
  Lists all bird or marine mammal records (identified by a unique `obskey`) and 
  includes relevant observation-specific parameters; has a many-to-one 
  relationship with the Position data table; no entries should be made for 
  positions or observation bins without observations. Each record represents a 
  single observation of (a group of) birds or (a pack of) marine mammals. 
  Observations are generally of individuals with the same characteristics 
  (distance, species, age, ...).
fields: 
  - name: obskey
    description: >
      Unique identifier for each observation within a trip. Recommended 
      practice is to use a persistent identifier (i.e. one that does not change 
      through time).
    type: string
    format: default
    constraints:
      required: true
      unique: true

  - name: poskey
    description: >
      The link to the position table for each species record.
    type: string
    format: default
    constraints:
      required: true

  - name: transect
    description: >
      States whether the observation was in or out the transect:
      - 1 Out of transect
      - 2 Inside transect
      - 3 Out of transect and of 90 deg scan
    type: integer
    format: default
    constraints:
      required: true
      enum:
        - 1
        - 2
        - 3

  - name: euring_species_code
    description: >
      The species code – see relational lookup table linking the codes with the 
      English and Latin species names. The species codes are largely based on 
      the EURING list but supplemented with ‘uncertainty codes’ commonly used 
      by ESAS partners to indicate species groups that are often difficult to 
      identify in at-sea field conditions.
    type: integer
    format: default
    constraints:
      required: true

  - name: number
    description: >
      The number of birds or marine mammals counted or estimated. This should 
      equal the number without distance correction.
    type: integer
    format: default
    constraints:
      required: true

  - name: distance
    description: |
      This is the distance at which the bird(s) or marine mammal(s) was/were 
      observed. Different distance bins are used for ship-based and aerial 
      surveys:

      For ship-based surveys (`platform_type` = `1`):

      A standard 300 m transect is  assumed for marine mammals and birds in 
      contact with the water:
      - A In contact with the water, 0 - 50 m
      - B In contact with the water, 50 - 100 m
      - C In contact with the water, 100 - 200 m
      - D In contact with the water, 200 - 300 m
      - E In contact with the water, > 300 m, beyond strip transect
      - F Flying, no contact with water
      - U Unknown
      - W In contact with the water, but distance not recorded

      For any other type of distance bin classification in ship-based suryeys 
      or aerial surveys (`platform_type` = `3`):

      Distance is indicated by the distance (m) to middle point of one the 
      distance bins specified in the `distance_bins` column in the Trips table; 
      observations outside this transect are indicated by a `>` sign 
      (e.g. `>1000`); unknown distance is indicated by `U`
    type: string
    format: default
    constraints:
      required: true

  - name: age_class
    description: |
      Age class or information on primary moult:
      - A Adult
      - I Immature (not specified)
      - 1 1st calendar year
      - 2 2nd calendar year
      - 3 3rd calendar year
      - 4 4th calendar year
      - 5 5th calendar year
      - X Active primary moult
      - Y No active primary moult
      
      (Primary moult codes only used for fulmar, auks, divers and seaduck.)
    type: string
    format: default
    constraints:
      required: false
      enum:
        - A
        - I
        - '1'
        - '2'
        - '3'
        - '4'
        - '5'
        - X
        - Y

  - name: plumage
    description: |
      Plumage types:
      - B Breeding (summer) plumage
      - T Transient plumage (moulting between winter & summer plumage or vice-versa)
      - W Non-breeding (winter) plumage
      - L Light morph (skuas/double light ‘LL’ fulmars)
      - C Coloured morph (‘L’, ‘D’ & ‘DD’ fulmars)
      - I Intermediate morph (skuas)
      - D Dark morph (skuas)
      - P Pullus

      For immature auks (Guillemot & Razorbill):
      - A1 ½ or less than adult size
      - A2 Over ½ adult size
      - A3 About same size as adult

      For immature Northern Gannets:
      - G1 Plumage 1
      - G2 Plumage 2
      - G3 Plumage 3
      - G4 Plumage 4
      - G5 Plumage 5
    type: string
    format: default
    constraints:
      required: false
      enum:
        - B
        - T
        - W
        - L
        - C
        - I
        - D
        - P
        - A1
        - A2
        - A3
        - G1
        - G2
        - G3
        - G4
        - G5

  - name: sex
    description: |
      - F Female
      - M Male 
    type: string
    format: default
    constraints:
      required: false
      enum:
        - F
        - M

  - name: group
    description: >
      Identifier of aggregations of individuals of one or several species; 
      should be unique among all observations from the same `tripkey`.
    type: string
    format: default
    constraints:
      required: false

  - name: direction_of_travel
    description: |
      The direction in which the bird/cetacean is travelling:
      - N Heading N
      - NE Heading NE
      - E Heading E
      - SE Heading SE
      - S Heading S
      - SW Heading SW
      - W Heading W
      - NW Heading NW
      - U Flying, no apparent direction

      Alternatively direction of travel can be indicated in degrees with 
      increments of 10° (for example in case of relative direction recording).
    type: string
    format: default
    constraints:
      required: false
      enum:
        - N
        - NE
        - E
        - SE
        - S
        - SW
        - W
        - NW
        - U
        - '0'
        - '10'
        - '20'
        - '30'
        - '40'
        - '50'
        - '60'
        - '70'
        - '80'
        - '90'
        - '100'
        - '110'
        - '120'
        - '130'
        - '140'
        - '150'
        - '160'
        - '170'
        - '180'
        - '190'
        - '200'
        - '210'
        - '220'
        - '230'
        - '240'
        - '250'
        - '260'
        - '270'
        - '280'
        - '290'
        - '300'
        - '310'
        - '320'
        - '330'
        - '340'
        - '350'
        - '360'

  - name: prey
    description: > # TODO: add lookup table?
      Observed prey (type) caught or carried by the bird/cetacean – see lookup 
      table.
    type: integer
    format: default
    constraints:
      required: false

  - name: association
    description: > # TODO: add lookup table?
      Code for associations between observed birds/cetaceans and 
      vessels/structures/floating matter – see lookup table.
    type: integer
    format: default
    constraints:
      required: false

  - name: activity
    description: |
      Indicates what the species was doing when observed:
      - 1 On water/swimming
      - 2 Diving
      - 3 Flushing
      - 4 Flying
      - 5 Completely submerged (marine mammals)
      - 6 Breaking surface (marine mammals)
      - 7 On artificial piece of something (platform, pole…)
    type: integer
    format: default
    constraints:
      required: false
      enum:
        - 1
        - 2
        - 3
        - 4
        - 5
        - 6
        - 7

  - name: behaviour
    description: > # TODO: add lookup table?
      Indicates what the species was doing when observed – see lookup table.
    type: integer
    format: default
    constraints:
      required: false

  - name: notes
    description: >
      Additional details related to the observation.
    type: string
    format: default
    constraints:
      required: false

missingValues:
  - ''
  - NA
primaryKey: obskey
foreignKeys:
  - fields: poskey
    reference:
      resource: positions
      fields: poskey
